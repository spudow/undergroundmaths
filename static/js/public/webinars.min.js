!function(){angular.module("cmWebinars",["MathematicalClassroomCore"]).controller("WebinarsController",["$scope","$timeout","$location","$sce","Webinar","Auth",function(a,b,c,d,e,f){var g=cmHelper.getUrlParameters("/webinars",["friendlyId"]);g.friendlyId&&c.path("/webinars").replace(),a.viewModel={},a.mathematicalClassroomRootViewModel.headerMenuItemSelected="Webinars",a.viewModel.upcomingWebinars={},a.viewModel.upcomingWebinars.loaded=!1,a.viewModel.upcomingWebinars.detailList=[],a.viewModel.upcomingWebinars.pageSize=6,a.viewModel.upcomingWebinars.totalRows=0,a.viewModel.upcomingWebinars.currentPage=0,a.viewModel.upcomingWebinars.initalized=!1,a.viewModel.upcomingWebinars.getCurrentRow=function(){var b=a.viewModel.upcomingWebinars.pageSize||0;return(a.viewModel.upcomingWebinars.currentPage||0)*b},a.viewModel.upcomingWebinars.pageChange=function(){a.getUpcomingWebinars()},a.getUpcomingWebinars=function(){var c=g.friendlyId&&!a.viewModel.upcomingWebinars.loaded?g.friendlyId:void 0;a.viewModel.upcomingWebinars.initalized=!0,e.queryConverted({displayLocation:"Upcoming",selected:c,startRow:a.viewModel.upcomingWebinars.getCurrentRow(),maxRows:a.viewModel.upcomingWebinars.pageSize},function(c){if(a.viewModel.upcomingWebinars.detailList=c.results,a.viewModel.upcomingWebinars.totalRows=c.totalRows,g.friendlyId&&!a.viewModel.upcomingWebinars.loaded){var d=a.viewModel.upcomingWebinars.detailList.filter(function(a){return a.webinar.friendlyId==g.friendlyId});d.length>0&&b(function(){a.toggleWebinar(d[0])})}b(function(){cmSite.processContent()}),a.viewModel.upcomingWebinars.loaded=!0},function(){a.viewModel.upcomingWebinars.loaded=!0})},a.viewModel.upcomingWebinars.initialized||a.getUpcomingWebinars(),a.viewModel.recordedWebinars={},a.viewModel.recordedWebinars.loaded=!1,a.viewModel.recordedWebinars.detailList=[],a.viewModel.recordedWebinars.pageSize=6,a.viewModel.recordedWebinars.totalRows=0,a.viewModel.recordedWebinars.currentPage=0,a.viewModel.recordedWebinars.initalized=!1,a.viewModel.recordedWebinars.getCurrentRow=function(){var b=a.viewModel.recordedWebinars.pageSize||0;return(a.viewModel.recordedWebinars.currentPage||0)*b},a.viewModel.recordedWebinars.pageChange=function(){a.getRecordedWebinars()},a.getRecordedWebinars=function(){var c=g.friendlyId&&!a.viewModel.upcomingWebinars.loaded?g.friendlyId:void 0;a.viewModel.recordedWebinars.initalized=!0,e.queryConverted({displayLocation:"Recorded",selected:c,startRow:a.viewModel.recordedWebinars.getCurrentRow(),maxRows:a.viewModel.recordedWebinars.pageSize},function(c){if(a.viewModel.recordedWebinars.detailList=c.results,a.viewModel.recordedWebinars.totalRows=c.totalRows,g.friendlyId&&!a.viewModel.recordedWebinars.loaded){var d=a.viewModel.recordedWebinars.detailList.filter(function(a){return a.webinar.friendlyId==g.friendlyId});d.length>0&&b(function(){h?a.toggleWebinar(d[0]):(a.scrollToWebinar(d[0]),$(window).on("load",function(){a.toggleWebinar(d[0],0)}))})}b(function(){cmSite.processContent()}),a.viewModel.recordedWebinars.loaded=!0},function(){a.viewModel.recordedWebinars.loaded=!0})},a.viewModel.recordedWebinars.initialized||a.getRecordedWebinars();var h=!1;$(window).on("load",function(){h=!0}),a.toggleWebinar=function(b,c){var d=$('[data-cm-webinar="'+b.webinar.id+'"]');0!=d.length&&a.scrollToWebinar(b,c,function(){d.animate({opacity:.5},500).animate({opacity:1},500)})},a.scrollToWebinar=function(a,b,c){var d=$('[data-cm-webinar="'+a.webinar.id+'"]');if(0!=d.length){var e=null==b?300:b;$("html, body").animate({scrollTop:d.offset().top-70},e).promise().then(function(){c&&c()})}},a.scrollToSection=function(a){var b=$("#"+a);0!=b.length&&$("html, body").animate({scrollTop:b.offset().top},300)},a.goToHubPage=function(a){var b=cmHelper.setSessionStorage("hub.initialSection",JSON.stringify(a));location.href=b?"/hub":"/hub#"+a}}])}();